<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANTI RUB - –°—Ç–µ–π–∫–∏–Ω–≥ –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–≤–∞–ª—å–≤–∞—Ü–∏–∏ —Ä—É–±–ª—è</title>
    
    <!-- Ethers.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #4ade80;
            --dark: #0a0a0a;
            --gray: #888;
            --red: #ef4444;
            --card-bg: rgba(255,255,255,0.05);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--dark);
            color: #fff;
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        /* Animated Background */
        .bg-animated {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            opacity: 0.05;
        }
        
        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 20px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8em;
            font-weight: bold;
        }
        
        .logo-text {
            font-size: 1.8em;
            font-weight: bold;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .nav-right {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .lang-switcher {
            display: flex;
            gap: 10px;
            background: var(--card-bg);
            border-radius: 20px;
            padding: 5px;
        }
        
        .lang-btn {
            padding: 8px 15px;
            border-radius: 15px;
            border: none;
            background: transparent;
            color: var(--gray);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }
        
        .lang-btn.active {
            background: var(--primary);
            color: white;
        }
        
        .connect-btn {
            padding: 12px 30px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .connect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102,126,234,0.5);
        }
        
        .wallet-info {
            display: none;
            flex-direction: column;
            align-items: flex-end;
            gap: 5px;
        }
        
        .wallet-info.connected {
            display: flex;
        }
        
        .wallet-address {
            font-size: 0.9em;
            color: var(--accent);
            cursor: pointer;
        }
        
        .wallet-balance {
            font-size: 0.8em;
            color: var(--gray);
        }
        
        .disconnect-btn {
            font-size: 0.8em;
            color: var(--red);
            background: none;
            border: none;
            cursor: pointer;
            margin-top: 5px;
        }
        
        /* Wallet Modal */
        .wallet-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .wallet-modal.show {
            display: flex;
        }
        
        .wallet-modal-content {
            background: rgba(20, 20, 20, 0.98);
            border: 2px solid rgba(102,126,234,0.3);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        .wallet-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .wallet-modal-title {
            font-size: 1.5em;
            font-weight: bold;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .wallet-modal-close {
            background: none;
            border: none;
            color: #fff;
            font-size: 1.5em;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .wallet-modal-close:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .wallet-options {
            display: grid;
            gap: 15px;
        }
        
        .wallet-option {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: var(--card-bg);
            border: 2px solid rgba(102,126,234,0.2);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .wallet-option:hover {
            border-color: var(--primary);
            transform: translateX(5px);
            box-shadow: 0 10px 30px rgba(102,126,234,0.3);
        }
        
        .wallet-option.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .wallet-option.disabled:hover {
            transform: none;
            border-color: rgba(102,126,234,0.2);
        }
        
        .wallet-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            background: rgba(255,255,255,0.1);
        }
        
        .wallet-details {
            flex: 1;
        }
        
        .wallet-name {
            font-weight: 600;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .wallet-description {
            font-size: 0.85em;
            color: var(--gray);
        }
        
        .wallet-tag {
            background: var(--primary);
            color: white;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.75em;
            font-weight: 600;
        }
        
        .wallet-tag.detected {
            background: var(--accent);
        }
        
        .wallet-tag.not-found {
            background: var(--gray);
        }
        
        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 100px auto 50px;
            padding: 20px;
        }
        
        /* Hero Stats */
        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: var(--card-bg);
            border: 2px solid rgba(102,126,234,0.3);
            border-radius: 20px;
            padding: 30px;
            transition: all 0.3s;
            text-align: center;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 15px 40px rgba(102,126,234,0.3);
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(45deg, var(--accent), #22c55e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-change {
            margin-top: 10px;
            font-size: 0.9em;
        }
        
        .stat-change.positive {
            color: var(--accent);
        }
        
        .stat-change.negative {
            color: var(--red);
        }
        
        /* Rate Card */
        .rate-card {
            background: linear-gradient(135deg, rgba(102,126,234,0.1), rgba(118,75,162,0.1));
            border: 2px solid var(--primary);
        }
        
        .rate-value {
            font-size: 3em;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .rate-timestamp {
            font-size: 0.8em;
            color: var(--gray);
            margin-top: 5px;
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .dashboard-card {
            background: var(--card-bg);
            border: 2px solid rgba(102,126,234,0.2);
            border-radius: 20px;
            padding: 30px;
            transition: all 0.3s;
        }
        
        .dashboard-card:hover {
            border-color: var(--primary);
            box-shadow: 0 15px 40px rgba(102,126,234,0.2);
        }
        
        .card-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-icon {
            font-size: 1.5em;
        }
        
        .balance-display {
            background: rgba(74,222,128,0.1);
            border: 2px solid var(--accent);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .balance-amount {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--accent);
        }
        
        .balance-usd {
            color: var(--gray);
            margin-top: 5px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-label {
            display: block;
            margin-bottom: 10px;
            color: var(--gray);
            font-size: 0.9em;
        }
        
        .input-wrapper {
            position: relative;
            display: flex;
            gap: 10px;
        }
        
        .input-field {
            flex: 1;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(102,126,234,0.3);
            border-radius: 12px;
            color: white;
            font-size: 1em;
            transition: all 0.3s;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(102,126,234,0.3);
        }
        
        .max-btn {
            padding: 10px 20px;
            background: rgba(102,126,234,0.2);
            border: 2px solid var(--primary);
            border-radius: 12px;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .max-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        .action-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102,126,234,0.5);
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .action-btn.secondary {
            background: rgba(102,126,234,0.2);
            border: 2px solid var(--primary);
        }
        
        .staking-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .info-item {
            background: rgba(255,255,255,0.03);
            padding: 15px;
            border-radius: 12px;
        }
        
        .info-label {
            color: var(--gray);
            font-size: 0.85em;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.3em;
            font-weight: 600;
            color: var(--accent);
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 100px;
            right: -400px;
            background: var(--card-bg);
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            min-width: 300px;
            z-index: 3000;
            transition: right 0.5s;
            backdrop-filter: blur(20px);
        }
        
        .notification.show {
            right: 20px;
        }
        
        .notification.success {
            border-color: var(--accent);
        }
        
        .notification.error {
            border-color: var(--red);
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 60px;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }
        
        .footer-links a {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-links a:hover {
            color: var(--accent);
        }
        
        .no-wallets-msg {
            text-align: center;
            padding: 30px;
            color: var(--gray);
        }
        
        .no-wallets-msg h3 {
            color: white;
            margin-bottom: 15px;
        }
        
        .install-links {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        
        .install-link {
            padding: 12px 20px;
            background: var(--card-bg);
            border: 2px solid var(--primary);
            border-radius: 12px;
            color: var(--primary);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .install-link:hover {
            background: var(--primary);
            color: white;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            nav {
                padding: 15px 20px;
                flex-wrap: wrap;
            }
            
            .logo-text {
                font-size: 1.3em;
            }
            
            .nav-right {
                width: 100%;
                justify-content: space-between;
                margin-top: 15px;
            }
            
            .container {
                margin-top: 150px;
            }
            
            .hero-stats {
                grid-template-columns: 1fr;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .wallet-modal-content {
                padding: 25px;
            }
            
            .staking-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animated"></div>
    
    <nav>
        <div class="logo">
            <div class="logo-icon">‚ÇΩ</div>
            <div class="logo-text">ANTI RUB</div>
        </div>
        
        <div class="nav-right">
            <div class="lang-switcher">
                <button class="lang-btn active" onclick="switchLanguage('ru')">RU</button>
                <button class="lang-btn" onclick="switchLanguage('en')">EN</button>
            </div>
            
            <button class="connect-btn" id="connectBtn" onclick="openWalletModal()">
                <span class="connect-text">–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫</span>
            </button>
            
            <div class="wallet-info" id="walletInfo">
                <div class="wallet-address" id="walletAddress" onclick="copyAddress()"></div>
                <div class="wallet-balance" id="walletBalance">0 ETH</div>
                <button class="disconnect-btn" onclick="disconnectWallet()">–û—Ç–∫–ª—é—á–∏—Ç—å</button>
            </div>
        </div>
    </nav>
    
    <!-- Wallet Modal -->
    <div class="wallet-modal" id="walletModal">
        <div class="wallet-modal-content">
            <div class="wallet-modal-header">
                <h2 class="wallet-modal-title">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫</h2>
                <button class="wallet-modal-close" onclick="closeWalletModal()">√ó</button>
            </div>
            
            <div class="wallet-options" id="walletOptions">
                <!-- Wallets will be dynamically loaded here -->
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- Hero Stats -->
        <div class="hero-stats">
            <div class="stat-card rate-card">
                <div class="stat-label">USDT/RUB –ö—É—Ä—Å</div>
                <div class="rate-value" id="usdtRubRate">0.00 ‚ÇΩ</div>
                <div class="rate-timestamp" id="rateTimestamp">–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è...</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">–î–µ–≤–∞–ª—å–≤–∞—Ü–∏—è —Ä—É–±–ª—è</div>
                <div class="stat-value" id="devaluation">0%</div>
                <div class="stat-change negative" id="devaluationChange">‚Üì -0.0% –∑–∞ –º–µ—Å—è—Ü</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">–í—Å–µ–≥–æ –∑–∞—Å—Ç–µ–π–∫–∞–Ω–æ</div>
                <div class="stat-value" id="totalStaked">0</div>
                <div class="stat-change positive">ANTI RUB —Ç–æ–∫–µ–Ω–æ–≤</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">APY</div>
                <div class="stat-value">12%</div>
                <div class="stat-change positive">+ –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–≤–∞–ª—å–≤–∞—Ü–∏–∏</div>
            </div>
        </div>
        
        <!-- Dashboard -->
        <div class="dashboard-grid">
            <!-- Balance Card -->
            <div class="dashboard-card">
                <h3 class="card-title">
                    <span class="card-icon">üí∞</span>
                    –í–∞—à –±–∞–ª–∞–Ω—Å
                </h3>
                
                <div class="balance-display">
                    <div class="balance-amount" id="userBalance">0.00</div>
                    <div class="balance-label">ANTI RUB</div>
                    <div class="balance-usd" id="usdValue">$0.00</div>
                </div>
                
                <div class="staking-info">
                    <div class="info-item">
                        <div class="info-label">–ó–∞—Å—Ç–µ–π–∫–∞–Ω–æ</div>
                        <div class="info-value" id="stakedAmount">0</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                        <div class="info-value" id="rewardsEarned">0</div>
                    </div>
                </div>
            </div>
            
            <!-- Staking Card -->
            <div class="dashboard-card">
                <h3 class="card-title">
                    <span class="card-icon">üîí</span>
                    –°—Ç–µ–π–∫–∏–Ω–≥
                </h3>
                
                <div class="input-group">
                    <label class="input-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤</label>
                    <div class="input-wrapper">
                        <input type="number" class="input-field" id="stakeAmount" placeholder="0.00">
                        <button class="max-btn" onclick="setMaxAmount()">MAX</button>
                    </div>
                </div>
                
                <button class="action-btn secondary" onclick="approveTokens()">
                    1Ô∏è‚É£ –û–¥–æ–±—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω—ã
                </button>
                
                <button class="action-btn" onclick="stakeTokens()">
                    2Ô∏è‚É£ –ó–∞—Å—Ç–µ–π–∫–∞—Ç—å
                </button>
                
                <button class="action-btn secondary" onclick="unstakeTokens()">
                    –í—ã–≤–µ—Å—Ç–∏ –∏–∑ —Å—Ç–µ–π–∫–∏–Ω–≥–∞
                </button>
            </div>
            
            <!-- Rewards Card -->
            <div class="dashboard-card">
                <h3 class="card-title">
                    <span class="card-icon">üéÅ</span>
                    –ù–∞–≥—Ä–∞–¥—ã
                </h3>
                
                <div class="balance-display">
                    <div class="balance-amount" id="rewardsDisplay">0.00</div>
                    <div class="balance-label">ANTI RUB</div>
                    <div class="balance-usd">–ù–∞–≥—Ä–∞–¥—ã –≥–æ—Ç–æ–≤—ã –∫ –≤—ã–≤–æ–¥—É</div>
                </div>
                
                <button class="action-btn" onclick="claimRewards()">
                    –ó–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—ã
                </button>
                
                <div class="info-item" style="margin-top: 20px;">
                    <div class="info-label">APY</div>
                    <div class="info-value">12%</div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>ANTI RUB - –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–≤–∞–ª—å–≤–∞—Ü–∏–∏ —Ä—É–±–ª—è —á–µ—Ä–µ–∑ –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–µ–π–∫–∏–Ω–≥</p>
        <div class="footer-links">
            <a href="#">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a>
            <a href="#">GitHub</a>
            <a href="#">Telegram</a>
            <a href="#">Twitter</a>
        </div>
        <p style="margin-top: 20px; font-size: 0.85em;">‚ö†Ô∏è –ü—Ä–æ–µ–∫—Ç –≤ —Å—Ç–∞–¥–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫.</p>
    </footer>
    
    <!-- Notification -->
    <div class="notification" id="notification"></div>
    
    <script>
        // ==========================================
        // TRANSLATIONS
        // ==========================================
        const translations = {
            ru: {
                'connect-wallet': '–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫',
                'disconnect': '–û—Ç–∫–ª—é—á–∏—Ç—å',
                'choose-wallet': '–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫',
                'connect-first': '–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫',
                'invalid-amount': '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É',
                'approving': '–û–¥–æ–±—Ä–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤...',
                'approve-success': '–¢–æ–∫–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ –æ–¥–æ–±—Ä–µ–Ω—ã!',
                'approve-error': '–û—à–∏–±–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏—è: ',
                'staking': '–°—Ç–µ–π–∫–∏–Ω–≥ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ...',
                'stake-success': '–¢–æ–∫–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Å—Ç–µ–π–∫–∞–Ω—ã!',
                'stake-error': '–û—à–∏–±–∫–∞ —Å—Ç–µ–π–∫–∏–Ω–≥–∞: ',
                'unstaking': '–í—ã–≤–æ–¥ –∏–∑ —Å—Ç–µ–π–∫–∏–Ω–≥–∞...',
                'unstake-success': '–¢–æ–∫–µ–Ω—ã –≤—ã–≤–µ–¥–µ–Ω—ã –∏–∑ —Å—Ç–µ–π–∫–∏–Ω–≥–∞!',
                'unstake-error': '–û—à–∏–±–∫–∞ –≤—ã–≤–æ–¥–∞: ',
                'claiming': '–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥...',
                'claim-success': '–ù–∞–≥—Ä–∞–¥—ã –ø–æ–ª—É—á–µ–Ω—ã!',
                'claim-error': '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥: ',
                'wallet-not-found': '–ö–æ—à–µ–ª–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω',
                'wallet-rejected': '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ',
                'switch-network': '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ Arbitrum',
                'copied': '–ê–¥—Ä–µ—Å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!',
                'connecting': '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...'
            },
            en: {
                'connect-wallet': 'Connect Wallet',
                'disconnect': 'Disconnect',
                'choose-wallet': 'Choose Wallet',
                'connect-first': 'Please connect wallet first',
                'invalid-amount': 'Enter valid amount',
                'approving': 'Approving tokens...',
                'approve-success': 'Tokens approved successfully!',
                'approve-error': 'Approval error: ',
                'staking': 'Staking in progress...',
                'stake-success': 'Tokens staked successfully!',
                'stake-error': 'Staking error: ',
                'unstaking': 'Unstaking...',
                'unstake-success': 'Tokens unstaked!',
                'unstake-error': 'Unstake error: ',
                'claiming': 'Claiming rewards...',
                'claim-success': 'Rewards claimed!',
                'claim-error': 'Claim error: ',
                'wallet-not-found': 'Wallet not found',
                'wallet-rejected': 'Connection rejected',
                'switch-network': 'Please switch to Arbitrum',
                'copied': 'Address copied!',
                'connecting': 'Connecting...'
            }
        };
        
        let currentLang = 'ru';
        
        function switchLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            updateUILanguage();
        }
        
        function updateUILanguage() {
            document.querySelector('.connect-text').textContent = 
                translations[currentLang]['connect-wallet'];
            document.querySelector('.wallet-modal-title').textContent = 
                translations[currentLang]['choose-wallet'];
            document.querySelector('.disconnect-btn').textContent = 
                translations[currentLang]['disconnect'];
        }
        
        // ==========================================
        // WALLET DETECTION & CONNECTION
        // ==========================================
        let provider = null;
        let signer = null;
        let userAddress = null;
        let currentWalletType = null;
        
        // Contract addresses (Arbitrum Sepolia Testnet)
        const TOKEN_ADDRESS = '0x0000000000000000000000000000000000000000';
        const STAKING_ADDRESS = '0x0000000000000000000000000000000000000000';
        
        // Arbitrum Chain ID
        const ARBITRUM_CHAIN_ID = '0xA4B1'; // Mainnet
        const ARBITRUM_TESTNET_CHAIN_ID = '0x66EEE'; // Sepolia
        
        // Contract ABIs (simplified)
        const TOKEN_ABI = [
            "function balanceOf(address) view returns (uint256)",
            "function approve(address spender, uint256 amount) returns (bool)",
            "function transfer(address to, uint256 amount) returns (bool)"
        ];
        
        const STAKING_ABI = [
            "function stake(uint256 amount)",
            "function unstake(uint256 amount)",
            "function claimRewards()",
            "function getStakedAmount(address user) view returns (uint256)",
            "function getRewards(address user) view returns (uint256)",
            "function totalStaked() view returns (uint256)"
        ];
        
        let tokenContract = null;
        let stakingContract = null;
        
        // Wallet definitions (lower priority number = checked first)
        const knownWallets = [
            {
                id: 'uniswap',
                name: 'Uniswap Extension',
                icon: 'ü¶Ñ',
                description: '–ö–æ—à–µ–ª–µ–∫ –æ—Ç Uniswap',
                check: (p) => p.isUniswap || (p.constructor && p.constructor.name && p.constructor.name.includes('Uniswap')),
                installUrl: 'https://uniswap.org/',
                priority: 1
            },
            {
                id: 'coinbase',
                name: 'Coinbase Wallet',
                icon: 'üíº',
                description: '–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ—à–µ–ª–µ–∫ Coinbase',
                check: (p) => p.isCoinbaseWallet && !p.isMetaMask,
                installUrl: 'https://www.coinbase.com/wallet',
                priority: 2
            },
            {
                id: 'rabby',
                name: 'Rabby Wallet',
                icon: 'üê∞',
                description: '–ú—É–ª—å—Ç–∏-—á–µ–π–Ω –∫–æ—à–µ–ª–µ–∫',
                check: (p) => p.isRabby,
                installUrl: 'https://rabby.io/',
                priority: 2
            },
            {
                id: 'trust',
                name: 'Trust Wallet',
                icon: 'üõ°Ô∏è',
                description: '–ë—Ä–∞—É–∑–µ—Ä–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ',
                check: (p) => p.isTrust,
                installUrl: 'https://trustwallet.com/',
                priority: 2
            },
            {
                id: 'brave',
                name: 'Brave Wallet',
                icon: 'ü¶Å',
                description: '–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–æ—à–µ–ª–µ–∫ Brave',
                check: (p) => p.isBraveWallet,
                installUrl: 'https://brave.com/wallet/',
                priority: 2
            },
            {
                id: 'metamask',
                name: 'MetaMask',
                icon: 'ü¶ä',
                description: '–ü–æ–ø—É–ª—è—Ä–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –∫–æ—à–µ–ª–µ–∫',
                check: (p) => p.isMetaMask && !p.isUniswap && !p.overrideIsMetaMask,
                installUrl: 'https://metamask.io/download/',
                priority: 3
            }
        ];
        
        // Detect available wallets
        function detectWallets() {
            const detected = [];
            const notDetected = [];
            
            console.log('=== WALLET DETECTION START ===');
            
            if (typeof window.ethereum === 'undefined') {
                console.log('No window.ethereum found');
                knownWallets.forEach(wallet => {
                    notDetected.push({
                        ...wallet,
                        detected: false
                    });
                });
                return { detected, notDetected };
            }
            
            console.log('window.ethereum exists');
            console.log('window.ethereum.providers:', window.ethereum.providers);
            
            // Check for multiple providers
            const providers = window.ethereum.providers || [window.ethereum];
            console.log('Total providers found:', providers.length);
            
            providers.forEach((p, index) => {
                console.log(`Provider ${index}:`, {
                    isMetaMask: p.isMetaMask,
                    isCoinbaseWallet: p.isCoinbaseWallet,
                    isRabby: p.isRabby,
                    isTrust: p.isTrust,
                    isBraveWallet: p.isBraveWallet,
                    constructor: p.constructor?.name
                });
            });
            
            // Check known wallets in order of priority
            // First check for specific wallets (non-MetaMask forks)
            const sortedWallets = [...knownWallets].sort((a, b) => a.priority - b.priority);
            
            sortedWallets.forEach(walletDef => {
                // Skip if already found
                if (detected.find(d => d.id === walletDef.id)) {
                    return;
                }
                
                const foundProvider = providers.find(p => {
                    // Don't reuse providers that are already assigned
                    const alreadyUsed = detected.some(d => d.provider === p);
                    if (alreadyUsed) return false;
                    
                    return walletDef.check(p);
                });
                
                if (foundProvider) {
                    console.log(`‚úì ${walletDef.name} detected`);
                    detected.push({
                        ...walletDef,
                        detected: true,
                        provider: foundProvider
                    });
                } else {
                    console.log(`‚úó ${walletDef.name} not found`);
                    notDetected.push({
                        ...walletDef,
                        detected: false
                    });
                }
            });
            
            // Check for unknown wallets
            providers.forEach((p, index) => {
                const isKnown = knownWallets.some(w => w.check(p));
                if (!isKnown) {
                    let walletName = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–æ—à–µ–ª–µ–∫';
                    let walletIcon = 'üíé';
                    
                    // Try to identify by constructor name or other properties
                    const constructorName = p.constructor?.name || '';
                    
                    if (constructorName.includes('Uniswap') || p.isUniswap) {
                        walletName = 'Uniswap Extension';
                        walletIcon = 'ü¶Ñ';
                    }
                    
                    console.log(`‚úì Unknown wallet detected (Provider ${index}): ${walletName}`);
                    
                    detected.push({
                        id: 'unknown_' + index,
                        name: walletName,
                        icon: walletIcon,
                        description: '–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–π Web3 –∫–æ—à–µ–ª–µ–∫',
                        detected: true,
                        provider: p
                    });
                }
            });
            
            console.log('=== WALLET DETECTION END ===');
            console.log('Detected wallets:', detected.map(w => w.name));
            
            return { detected, notDetected };
        }
        
        // Render wallet options
        function renderWalletOptions() {
            const { detected, notDetected } = detectWallets();
            const container = document.getElementById('walletOptions');
            container.innerHTML = '';
            
            if (detected.length === 0) {
                // No wallets detected
                container.innerHTML = `
                    <div class="no-wallets-msg">
                        <h3>–ö–æ—à–µ–ª—å–∫–∏ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã</h3>
                        <p>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö Web3 –∫–æ—à–µ–ª—å–∫–æ–≤:</p>
                        <div class="install-links">
                            <a href="https://metamask.io/download/" target="_blank" class="install-link">
                                ü¶ä –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å MetaMask
                            </a>
                            <a href="https://www.coinbase.com/wallet" target="_blank" class="install-link">
                                üíº –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Coinbase Wallet
                            </a>
                            <a href="https://rabby.io/" target="_blank" class="install-link">
                                üê∞ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Rabby Wallet
                            </a>
                        </div>
                    </div>
                `;
                return;
            }
            
            // Render detected wallets
            detected.forEach(wallet => {
                const option = document.createElement('div');
                option.className = 'wallet-option';
                option.onclick = () => connectWallet(wallet);
                
                option.innerHTML = `
                    <div class="wallet-icon">${wallet.icon}</div>
                    <div class="wallet-details">
                        <div class="wallet-name">${wallet.name}</div>
                        <div class="wallet-description">${wallet.description}</div>
                    </div>
                    <span class="wallet-tag detected">‚úì –û–±–Ω–∞—Ä—É–∂–µ–Ω</span>
                `;
                
                container.appendChild(option);
            });
            
            // Render not detected wallets
            notDetected.forEach(wallet => {
                const option = document.createElement('div');
                option.className = 'wallet-option disabled';
                option.onclick = () => {
                    window.open(wallet.installUrl, '_blank');
                };
                
                option.innerHTML = `
                    <div class="wallet-icon">${wallet.icon}</div>
                    <div class="wallet-details">
                        <div class="wallet-name">${wallet.name}</div>
                        <div class="wallet-description">–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω - –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏</div>
                    </div>
                    <span class="wallet-tag not-found">–ù–µ –Ω–∞–π–¥–µ–Ω</span>
                `;
                
                container.appendChild(option);
            });
        }
        
        // Modal Functions
        function openWalletModal() {
            renderWalletOptions();
            document.getElementById('walletModal').classList.add('show');
        }
        
        function closeWalletModal() {
            document.getElementById('walletModal').classList.remove('show');
        }
        
        // Universal Wallet Connection
        async function connectWallet(wallet) {
            try {
                console.log('=== CONNECTING WALLET ===');
                console.log('Wallet to connect:', wallet.name);
                console.log('Wallet provider:', wallet.provider);
                
                if (!wallet.provider) {
                    showNotification('–ü—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    return;
                }
                
                showNotification(translations[currentLang]['connecting']);
                closeWalletModal();
                
                // IMPORTANT: Use the specific provider, not window.ethereum
                const ethereum = wallet.provider;
                
                console.log('Using provider:', {
                    isMetaMask: ethereum.isMetaMask,
                    isCoinbaseWallet: ethereum.isCoinbaseWallet,
                    isRabby: ethereum.isRabby,
                    constructor: ethereum.constructor?.name
                });
                
                // Request accounts from the SPECIFIC provider
                console.log('Requesting accounts...');
                const accounts = await ethereum.request({ 
                    method: 'eth_requestAccounts' 
                });
                console.log('Accounts received:', accounts);
                
                // Create provider from the SPECIFIC ethereum instance
                provider = new ethers.providers.Web3Provider(ethereum);
                await checkAndSwitchNetwork(ethereum);
                
                userAddress = accounts[0];
                signer = provider.getSigner();
                currentWalletType = wallet.id;
                
                console.log('Connected address:', userAddress);
                console.log('Wallet type:', currentWalletType);
                
                initializeContracts();
                updateWalletUI();
                await loadAllData();
                
                showNotification(`${wallet.name} –ø–æ–¥–∫–ª—é—á–µ–Ω!`, 'success');
                console.log('=== CONNECTION SUCCESSFUL ===');
                
                // Listen for events on the SPECIFIC provider
                ethereum.on('accountsChanged', handleAccountsChanged);
                ethereum.on('chainChanged', () => location.reload());
                
            } catch (error) {
                console.error('=== CONNECTION ERROR ===');
                console.error('Error details:', error);
                if (error.code === 4001) {
                    showNotification(translations[currentLang]['wallet-rejected'], 'error');
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + error.message, 'error');
                }
            }
        }
        
        // Disconnect Wallet
        async function disconnectWallet() {
            provider = null;
            signer = null;
            userAddress = null;
            tokenContract = null;
            stakingContract = null;
            currentWalletType = null;
            
            document.getElementById('connectBtn').style.display = 'block';
            document.getElementById('walletInfo').classList.remove('connected');
            
            showNotification('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω', 'info');
        }
        
        // Handle Account Changes
        function handleAccountsChanged(accounts) {
            if (accounts.length === 0) {
                disconnectWallet();
            } else {
                location.reload();
            }
        }
        
        // Check and Switch to Arbitrum
        async function checkAndSwitchNetwork(ethereum) {
            try {
                const chainId = await ethereum.request({ method: 'eth_chainId' });
                
                if (chainId !== ARBITRUM_CHAIN_ID && chainId !== ARBITRUM_TESTNET_CHAIN_ID) {
                    try {
                        await ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: ARBITRUM_CHAIN_ID }],
                        });
                    } catch (switchError) {
                        if (switchError.code === 4902) {
                            try {
                                await ethereum.request({
                                    method: 'wallet_addEthereumChain',
                                    params: [{
                                        chainId: ARBITRUM_CHAIN_ID,
                                        chainName: 'Arbitrum One',
                                        nativeCurrency: {
                                            name: 'Ethereum',
                                            symbol: 'ETH',
                                            decimals: 18
                                        },
                                        rpcUrls: ['https://arb1.arbitrum.io/rpc'],
                                        blockExplorerUrls: ['https://arbiscan.io']
                                    }],
                                });
                                location.reload();
                            } catch (addError) {
                                showNotification(translations[currentLang]['switch-network'], 'error');
                            }
                        }
                    }
                }
            } catch (error) {
                console.error('Network check error:', error);
            }
        }
        
        // Initialize Contracts
        function initializeContracts() {
            if (provider && signer) {
                tokenContract = new ethers.Contract(TOKEN_ADDRESS, TOKEN_ABI, signer);
                stakingContract = new ethers.Contract(STAKING_ADDRESS, STAKING_ABI, signer);
            }
        }
        
        // Update Wallet UI
        function updateWalletUI() {
            document.getElementById('connectBtn').style.display = 'none';
            document.getElementById('walletInfo').classList.add('connected');
            
            const shortAddress = userAddress.slice(0, 6) + '...' + userAddress.slice(-4);
            document.getElementById('walletAddress').textContent = shortAddress;
        }
        
        // Copy Address
        function copyAddress() {
            if (userAddress) {
                navigator.clipboard.writeText(userAddress);
                showNotification(translations[currentLang]['copied'], 'success');
            }
        }
        
        // ==========================================
        // LOAD DATA
        // ==========================================
        async function loadAllData() {
            try {
                // ETH Balance
                const ethBalance = await provider.getBalance(userAddress);
                const ethFormatted = ethers.utils.formatEther(ethBalance);
                document.getElementById('walletBalance').textContent = 
                    `${parseFloat(ethFormatted).toFixed(4)} ETH`;
                
                if (tokenContract) {
                    // Token Balance
                    const balance = await tokenContract.balanceOf(userAddress);
                    const balanceFormatted = ethers.utils.formatEther(balance);
                    document.getElementById('userBalance').textContent = 
                        parseFloat(balanceFormatted).toFixed(2);
                    
                    // USD Value
                    const usdValue = parseFloat(balanceFormatted) * 0.001;
                    document.getElementById('usdValue').textContent = 
                        `$${usdValue.toFixed(2)}`;
                }
                
                if (stakingContract) {
                    // Staked Amount
                    const staked = await stakingContract.getStakedAmount(userAddress);
                    const stakedFormatted = ethers.utils.formatEther(staked);
                    document.getElementById('stakedAmount').textContent = 
                        parseFloat(stakedFormatted).toFixed(2);
                    
                    // Rewards
                    const rewards = await stakingContract.getRewards(userAddress);
                    const rewardsFormatted = ethers.utils.formatEther(rewards);
                    document.getElementById('rewardsEarned').textContent = 
                        parseFloat(rewardsFormatted).toFixed(2);
                    document.getElementById('rewardsDisplay').textContent = 
                        parseFloat(rewardsFormatted).toFixed(2);
                    
                    // Total Staked
                    const totalStaked = await stakingContract.totalStaked();
                    const totalStakedFormatted = ethers.utils.formatEther(totalStaked);
                    document.getElementById('totalStaked').textContent = 
                        parseFloat(totalStakedFormatted).toFixed(0);
                }
                
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }
        
        // ==========================================
        // STAKING FUNCTIONS
        // ==========================================
        function setMaxAmount() {
            if (!userAddress) {
                showNotification(translations[currentLang]['connect-first'], 'error');
                return;
            }
            document.getElementById('stakeAmount').value = '1000';
        }
        
        async function approveTokens() {
            if (!userAddress || !tokenContract) {
                showNotification(translations[currentLang]['connect-first'], 'error');
                return;
            }
            
            const amount = document.getElementById('stakeAmount').value;
            if (!amount || parseFloat(amount) <= 0) {
                showNotification(translations[currentLang]['invalid-amount'], 'error');
                return;
            }
            
            try {
                showNotification(translations[currentLang]['approving']);
                
                const amountWei = ethers.utils.parseEther(amount);
                const tx = await tokenContract.approve(STAKING_ADDRESS, amountWei);
                await tx.wait();
                
                showNotification(translations[currentLang]['approve-success'], 'success');
                
            } catch (error) {
                console.error('Approve error:', error);
                showNotification(
                    translations[currentLang]['approve-error'] + error.message,
                    'error'
                );
            }
        }
        
        async function stakeTokens() {
            if (!userAddress || !stakingContract) {
                showNotification(translations[currentLang]['connect-first'], 'error');
                return;
            }
            
            const amount = document.getElementById('stakeAmount').value;
            if (!amount || parseFloat(amount) <= 0) {
                showNotification(translations[currentLang]['invalid-amount'], 'error');
                return;
            }
            
            try {
                showNotification(translations[currentLang]['staking']);
                
                const amountWei = ethers.utils.parseEther(amount);
                const tx = await stakingContract.stake(amountWei);
                await tx.wait();
                
                showNotification(translations[currentLang]['stake-success'], 'success');
                
                document.getElementById('stakeAmount').value = '';
                await loadAllData();
                
            } catch (error) {
                console.error('Staking error:', error);
                showNotification(
                    translations[currentLang]['stake-error'] + error.message,
                    'error'
                );
            }
        }
        
        async function unstakeTokens() {
            if (!userAddress || !stakingContract) {
                showNotification(translations[currentLang]['connect-first'], 'error');
                return;
            }
            
            const amount = document.getElementById('stakeAmount').value;
            if (!amount || parseFloat(amount) <= 0) {
                showNotification(translations[currentLang]['invalid-amount'], 'error');
                return;
            }
            
            try {
                showNotification(translations[currentLang]['unstaking']);
                
                const amountWei = ethers.utils.parseEther(amount);
                const tx = await stakingContract.unstake(amountWei);
                await tx.wait();
                
                showNotification(translations[currentLang]['unstake-success'], 'success');
                
                document.getElementById('stakeAmount').value = '';
                await loadAllData();
                
            } catch (error) {
                console.error('Unstaking error:', error);
                showNotification(
                    translations[currentLang]['unstake-error'] + error.message,
                    'error'
                );
            }
        }
        
        async function claimRewards() {
            if (!userAddress || !stakingContract) {
                showNotification(translations[currentLang]['connect-first'], 'error');
                return;
            }
            
            try {
                showNotification(translations[currentLang]['claiming']);
                
                const tx = await stakingContract.claimRewards();
                await tx.wait();
                
                showNotification(translations[currentLang]['claim-success'], 'success');
                
                await loadAllData();
                
            } catch (error) {
                console.error('Claiming error:', error);
                showNotification(
                    translations[currentLang]['claim-error'] + error.message,
                    'error'
                );
            }
        }
        
        // ==========================================
        // USDT/RUB RATE
        // ==========================================
        async function fetchUsdtRubRate() {
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await response.json();
                
                if (data && data.rates && data.rates.RUB) {
                    const rate = data.rates.RUB;
                    document.getElementById('usdtRubRate').textContent = 
                        `${rate.toFixed(2)} ‚ÇΩ`;
                    
                    const now = new Date();
                    document.getElementById('rateTimestamp').textContent = 
                        `–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${now.toLocaleTimeString('ru-RU')}`;
                    
                    // Calculate devaluation (mock data)
                    const devaluation = 5.2;
                    document.getElementById('devaluation').textContent = 
                        `${devaluation.toFixed(1)}%`;
                    document.getElementById('devaluationChange').textContent = 
                        `‚Üì -${(devaluation * 0.2).toFixed(1)}% –∑–∞ –º–µ—Å—è—Ü`;
                }
            } catch (error) {
                console.error('Error fetching rate:', error);
                document.getElementById('usdtRubRate').textContent = '–ù/–î';
            }
        }
        
        // ==========================================
        // NOTIFICATIONS
        // ==========================================
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }
        
        // ==========================================
        // INITIALIZATION
        // ==========================================
        window.addEventListener('DOMContentLoaded', async () => {
            await fetchUsdtRubRate();
            
            // Update rate every 60 seconds
            setInterval(fetchUsdtRubRate, 60000);
        });
    </script>
</body>
</html>
